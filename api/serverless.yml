service: rental-a-locker-api
frameworkVersion: "3"

plugins:
  - serverless-plugin-common-excludes # this should go before serverless-plugin-include-dependencies
  - serverless-plugin-include-dependencies
  - serverless-appsync-plugin
  - serverless-pseudo-parameters
  - serverless-deployment-bucket

provider:
  name: aws
  stage: dev
  region: us-east-1
  deploymentBucket:
    name: rental-a-locker-api-resources

custom:
  namespace: rental-a-locker
  service: api
  appSync:
    name: ${self:custom.namespace}-${self:custom.service}
    authenticationType: AWS_LAMBDA
    lambdaAuthorizerConfig:
      lambdaFunctionArn: arn:aws:lambda:${aws:region}:${aws:accountId}:function:${self:custom.namespace}-authorizer-${self:provider.stage}-Authorizer

    schema:
      - schema/booking.graphql
      - schema/image.graphql
      - schema/listing.graphql
      - schema/user.graphql
    mappingTemplatesLocation: ./aws/appsync/mapping-templates
    dataSources:
      - ${file(./aws/appsync/data-sources/booking.yml)}
      - ${file(./aws/appsync/data-sources/image.yml)}
      - ${file(./aws/appsync/data-sources/listing.yml)}
      - ${file(./aws/appsync/data-sources/user.yml)}
    mappingTemplates:
      - ${file(./aws/appsync/mapping-templates/booking/mapping-template.yml)}
      - ${file(./aws/appsync/mapping-templates/listing/mapping-template.yml)}
      - ${file(./aws/appsync/mapping-templates/image/mapping-template.yml)}
      - ${file(./aws/appsync/mapping-templates/user/mapping-template.yml)}
